<!-- NOMA Architecture Comparison SVG -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <!-- Définitions de styles -->
  <defs>
    <style>
      .title { font-family: monospace; font-size: 18px; font-weight: bold; fill: #ffffff; }
      .subtitle { font-family: monospace; font-size: 14px; fill: #cccccc; }
      .label { font-family: monospace; font-size: 12px; fill: #ffffff; }
      .small-text { font-family: monospace; font-size: 10px; fill: #999999; }
      .box { fill: #2a2a2a; stroke: #00ffcc; stroke-width: 2; rx: 5; }
      .highlight-box { fill: #1a4d4d; stroke: #00ffcc; stroke-width: 3; rx: 5; }
      .arrow { stroke: #00ffcc; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .slow-arrow { stroke: #ff6666; stroke-width: 2; fill: none; marker-end: url(#arrowhead-red); stroke-dasharray: 5,5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#00ffcc" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff6666" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="#0d1117"/>

  <!-- Title -->
  <text x="400" y="30" class="title" text-anchor="middle">NOMA: Compile-Time Autodiff vs Runtime Libraries</text>

  <!-- Left side: Traditional ML Frameworks -->
  <text x="200" y="70" class="subtitle" text-anchor="middle">Traditional (PyTorch/TensorFlow)</text>
  
  <!-- Source code -->
  <rect x="120" y="90" width="160" height="40" class="box"/>
  <text x="200" y="115" class="label" text-anchor="middle">Python Source</text>
  
  <!-- Arrow down -->
  <path d="M 200 130 L 200 160" class="slow-arrow"/>
  
  <!-- Interpreter -->
  <rect x="120" y="160" width="160" height="40" class="box"/>
  <text x="200" y="185" class="label" text-anchor="middle">Python Interpreter</text>
  
  <!-- Arrow down -->
  <path d="M 200 200 L 200 230" class="slow-arrow"/>
  
  <!-- PyTorch Library -->
  <rect x="120" y="230" width="160" height="40" class="box"/>
  <text x="200" y="255" class="label" text-anchor="middle">PyTorch/TF Runtime</text>
  
  <!-- Arrow down -->
  <path d="M 200 270 L 200 300" class="slow-arrow"/>
  
  <!-- Autograd Engine (Runtime) -->
  <rect x="120" y="300" width="160" height="50" class="box"/>
  <text x="200" y="320" class="label" text-anchor="middle">Autograd Engine</text>
  <text x="200" y="335" class="small-text" text-anchor="middle">(Runtime Graph Build)</text>
  
  <!-- Arrow down -->
  <path d="M 200 350 L 200 380" class="slow-arrow"/>
  
  <!-- Backward Pass -->
  <rect x="120" y="380" width="160" height="50" class="box"/>
  <text x="200" y="400" class="label" text-anchor="middle">Backward Pass</text>
  <text x="200" y="415" class="small-text" text-anchor="middle">(Runtime Gradients)</text>
  
  <!-- Bottom label -->
  <text x="200" y="460" class="small-text" text-anchor="middle" fill="#ff6666">Overhead on EVERY run</text>
  <text x="200" y="480" class="small-text" text-anchor="middle">Size: ~100 MB runtime</text>
  <text x="200" y="495" class="small-text" text-anchor="middle">Speed: Baseline (1x)</text>

  <!-- Right side: NOMA -->
  <text x="600" y="70" class="subtitle" text-anchor="middle">NOMA (Compile-Time)</text>
  
  <!-- Source code -->
  <rect x="520" y="90" width="160" height="40" class="box"/>
  <text x="600" y="115" class="label" text-anchor="middle">NOMA Source</text>
  
  <!-- Arrow down -->
  <path d="M 600 130 L 600 160" class="arrow"/>
  
  <!-- NOMA Compiler -->
  <rect x="520" y="160" width="160" height="40" class="box"/>
  <text x="600" y="185" class="label" text-anchor="middle">NOMA Compiler</text>
  
  <!-- Arrow down -->
  <path d="M 600 200 L 600 230" class="arrow"/>
  
  <!-- Autodiff Pass (HIGHLIGHT) -->
  <rect x="520" y="230" width="160" height="50" class="highlight-box"/>
  <text x="600" y="250" class="label" text-anchor="middle">AUTODIFF PASS</text>
  <text x="600" y="265" class="small-text" text-anchor="middle" fill="#00ffcc">✓ Compile-Time Only</text>
  
  <!-- Arrow down -->
  <path d="M 600 280 L 600 310" class="arrow"/>
  
  <!-- LLVM IR -->
  <rect x="520" y="310" width="160" height="40" class="box"/>
  <text x="600" y="335" class="label" text-anchor="middle">LLVM IR + Optimize</text>
  
  <!-- Arrow down -->
  <path d="M 600 350 L 600 380" class="arrow"/>
  
  <!-- Native Binary -->
  <rect x="520" y="380" width="160" height="50" class="highlight-box"/>
  <text x="600" y="400" class="label" text-anchor="middle">Native Binary</text>
  <text x="600" y="415" class="small-text" text-anchor="middle" fill="#00ffcc">✓ Standalone, No Deps</text>
  
  <!-- Bottom label -->
  <text x="600" y="460" class="small-text" text-anchor="middle" fill="#00ffcc">✓ Compiled ONCE, run forever</text>
  <text x="600" y="480" class="small-text" text-anchor="middle">Size: 16-50 KB</text>
  <text x="600" y="495" class="small-text" text-anchor="middle" fill="#00ffcc">Speed: 15x faster</text>

  <!-- Center divider -->
  <line x1="400" y1="80" x2="400" y2="510" stroke="#333333" stroke-width="1" stroke-dasharray="10,5"/>

  <!-- Bottom comparison box -->
  <rect x="50" y="520" width="700" height="70" class="box"/>
  
  <!-- Key difference text -->
  <text x="400" y="545" class="label" text-anchor="middle" fill="#00ffcc">KEY DIFFERENCE:</text>
  <text x="400" y="565" class="small-text" text-anchor="middle">PyTorch computes gradients at RUNTIME (slow, every execution)</text>
  <text x="400" y="580" class="small-text" text-anchor="middle">NOMA computes gradients at COMPILE-TIME (fast, baked into binary)</text>

</svg>
