<!-- NOMA Dynamic Topology Growth -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600" width="1000" height="600">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #ffffff; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #cccccc; font-weight: bold; }
      .label { font-family: Arial, sans-serif; font-size: 12px; fill: #ffffff; font-weight: bold; }
      .small-text { font-family: Arial, sans-serif; font-size: 11px; fill: #999999; }
      .code-text { font-family: monospace; font-size: 11px; fill: #00ffcc; }
      .box { fill: #2a2a2a; stroke: #00ffcc; stroke-width: 2; rx: 8; }
      .error-box { fill: #3a1a1a; stroke: #ff6666; stroke-width: 2; rx: 8; }
      .success-box { fill: #1a3a2a; stroke: #00ffcc; stroke-width: 3; rx: 8; }
      .arrow { stroke: #00ffcc; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .error-arrow { stroke: #ff6666; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead-error); stroke-dasharray: 5,5; }
      .divider { stroke: #444444; stroke-width: 1; stroke-dasharray: 8,4; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#00ffcc" />
    </marker>
    <marker id="arrowhead-error" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff6666" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="600" fill="#0d1117"/>

  <!-- Title -->
  <text x="500" y="35" class="title" text-anchor="middle">Dynamic Topology Growth: Network Expansion During Training</text>

  <!-- Left side label -->
  <text x="250" y="75" class="subtitle" text-anchor="middle">Traditional Approach (PyTorch)</text>
  
  <!-- Left: Step 1 -->
  <rect x="80" y="95" width="340" height="75" class="box"/>
  <text x="250" y="118" class="label" text-anchor="middle">Step 1: Initial Training</text>
  <text x="250" y="137" class="small-text" text-anchor="middle">Network: 2 neurons</text>
  <text x="250" y="151" class="small-text" text-anchor="middle">Loss: 0.8 (not converging)</text>
  <text x="250" y="165" class="code-text" text-anchor="middle">optimize(W) { ... }</text>

  <!-- Left: Arrow down -->
  <path d="M 250 170 L 250 190" class="error-arrow"/>

  <!-- Left: Step 2 -->
  <rect x="80" y="190" width="340" height="65" class="error-box"/>
  <text x="250" y="213" class="label" text-anchor="middle" fill="#ff6666">Step 2: STOP Training</text>
  <text x="250" y="232" class="small-text" text-anchor="middle" fill="#ff6666">Must exit optimization loop</text>
  <text x="250" y="246" class="small-text" text-anchor="middle" fill="#ff6666">Training interrupted</text>

  <!-- Left: Arrow down -->
  <path d="M 250 255 L 250 275" class="error-arrow"/>

  <!-- Left: Step 3 -->
  <rect x="80" y="275" width="340" height="105" class="box"/>
  <text x="250" y="298" class="label" text-anchor="middle">Step 3: Manual Restructuring</text>
  <text x="250" y="320" class="code-text" text-anchor="middle">new_model = Model(10)</text>
  <text x="250" y="335" class="code-text" text-anchor="middle">copy_weights(old_model, new_model)</text>
  <text x="250" y="350" class="code-text" text-anchor="middle">optimizer = Adam(new_model)</text>
  <text x="250" y="367" class="small-text" text-anchor="middle">Error-prone, requires boilerplate</text>

  <!-- Left: Arrow down -->
  <path d="M 250 380 L 250 400" class="error-arrow"/>

  <!-- Left: Step 4 -->
  <rect x="80" y="400" width="340" height="75" class="box"/>
  <text x="250" y="423" class="label" text-anchor="middle">Step 4: Resume Training</text>
  <text x="250" y="442" class="small-text" text-anchor="middle">Network: 10 neurons</text>
  <text x="250" y="456" class="small-text" text-anchor="middle">Optimizer state rebuilt</text>
  <text x="250" y="470" class="small-text" text-anchor="middle" fill="#999999">Complex and fragile</text>

  <!-- Divider -->
  <line x1="500" y1="65" x2="500" y2="560" class="divider"/>

  <!-- Right side label -->
  <text x="750" y="75" class="subtitle" text-anchor="middle">NOMA Approach</text>
  
  <!-- Right: Step 1 -->
  <rect x="580" y="95" width="340" height="75" class="box"/>
  <text x="750" y="118" class="label" text-anchor="middle">Step 1: Initial Training</text>
  <text x="750" y="137" class="small-text" text-anchor="middle">Network: 2 neurons</text>
  <text x="750" y="151" class="small-text" text-anchor="middle">Loss: 0.8 (not converging)</text>
  <text x="750" y="165" class="code-text" text-anchor="middle">optimize(W) { ... }</text>

  <!-- Right: Arrow down -->
  <path d="M 750 170 L 750 190" class="arrow"/>

  <!-- Right: Step 2 -->
  <rect x="580" y="190" width="340" height="90" class="success-box"/>
  <text x="750" y="213" class="label" text-anchor="middle" fill="#00ffcc">Step 2: Automatic Growth</text>
  <text x="750" y="232" class="code-text" text-anchor="middle">if loss > 0.5 {</text>
  <text x="750" y="247" class="code-text" text-anchor="middle">  realloc W = [10, 1];</text>
  <text x="750" y="262" class="code-text" text-anchor="middle">}</text>
  <text x="750" y="277" class="small-text" text-anchor="middle" fill="#00ffcc">Training continues without interruption</text>

  <!-- Right: Arrow down -->
  <path d="M 750 280 L 750 305" class="arrow"/>

  <!-- Right: Step 3 -->
  <rect x="580" y="305" width="340" height="75" class="box"/>
  <text x="750" y="328" class="label" text-anchor="middle">Step 3: Continue Training</text>
  <text x="750" y="347" class="small-text" text-anchor="middle">Network: 10 neurons</text>
  <text x="750" y="361" class="small-text" text-anchor="middle">Loss: 0.01 (converged)</text>
  <text x="750" y="375" class="small-text" text-anchor="middle" fill="#00ffcc">No manual intervention needed</text>

  <!-- Key benefits box -->
  <rect x="80" y="510" width="840" height="75" class="success-box"/>
  <text x="500" y="533" class="label" text-anchor="middle">Key Advantages of NOMA Approach</text>
  <text x="250" y="556" class="small-text" text-anchor="middle" fill="#00ffcc">Training never stops</text>
  <text x="500" y="556" class="small-text" text-anchor="middle" fill="#00ffcc">One line of code</text>
  <text x="750" y="556" class="small-text" text-anchor="middle" fill="#00ffcc">Optimizer state preserved</text>
  <text x="250" y="575" class="small-text" text-anchor="middle" fill="#00ffcc">No manual weight copying</text>
  <text x="500" y="575" class="small-text" text-anchor="middle" fill="#00ffcc">Clean, declarative syntax</text>
  <text x="750" y="575" class="small-text" text-anchor="middle" fill="#00ffcc">Compile-time safety</text>

</svg>
